<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Create 3D Regression Surfaces • regress3d</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Create 3D Regression Surfaces">
<meta name="description" content="Simple regressions can easily be visualized in 2 dimensions; regressions with 2 explanatory variables can be visualized using interactive 3 dimensional visuals. These 3 dimensional interactive visuals provide statisticians and data analysts a new method to interpret a variety of different common types of regressions.">
<meta property="og:description" content="Simple regressions can easily be visualized in 2 dimensions; regressions with 2 explanatory variables can be visualized using interactive 3 dimensional visuals. These 3 dimensional interactive visuals provide statisticians and data analysts a new method to interpret a variety of different common types of regressions.">
<meta property="og:image" content="https://ellafostermolina.github.io/regress3d/logo.png">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-21JNL53E33"></script><script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date());
gtag('config', 'G-21JNL53E33'); </script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">regress3d</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/linear_models_3d.html">Linear Regression Surfaces with Marginal Effects in 3D</a></li>
    <li><a class="dropdown-item" href="articles/linear_models_w_interactions_3d.html">Interaction Terms in 3D</a></li>
    <li><a class="dropdown-item" href="articles/generalized_linear_models_3d.html">Generalized Linear Models in 3D</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ellaFosterMolina/regress3d/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="regress3d">regress3d<a class="anchor" aria-label="anchor" href="#regress3d"></a>
</h1>
</div>
<!-- badges: start -->

<p><strong>regress3d</strong> is an R package for plotting regression surfaces and marginal effects in three dimensions. The plots created by <strong>regress3d</strong> are <strong>plotly</strong> objects. They can be customized using functions and arguments from the <strong>plotly</strong> package.</p>
<p>The core two functions of <strong>regress3d</strong> are</p>
<ul>
<li>
<code><a href="reference/add_3d_surface.html">add_3d_surface()</a></code>: create a three dimensional surface for a regression with two explanatory <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> variables , and</li>
<li>
<code><a href="reference/add_marginals.html">add_marginals()</a></code>: create a three dimensional visual for the marginal effects of a regression with two explanatory <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> variables.</li>
</ul>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>The vignettes walk you through examples of regression surfaces for three types of models.</p>
<ul>
<li><a href="https://ellafostermolina.github.io/regress3d/articles/linear_models_3d.html">Linear models</a></li>
<li><a href="https://ellafostermolina.github.io/regress3d/articles/linear_models_w_interactions_3d.html">Linear models with an interaction term</a></li>
<li><a href="https://ellafostermolina.github.io/regress3d/articles/generalized_linear_models_3d.html">Generalized linear models</a></li>
</ul>
<p>A handy feature for binomial glms and other regressions that use discrete data is the function <code><a href="reference/add_jitter.html">add_jitter()</a></code>. This function mimics <code><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">ggplot2::geom_jitter()</a></code> in <strong>ggplot2</strong>, helping users visualize overlaid points in a three dimensional graphic.</p>
<p>We recommend you start with the vignette on <a href="https://ellafostermolina.github.io/regress3d/articles/linear_models_3d.html">linear models</a>, which will introduce you to working with the interactive images, interpreting the regression surface, and understanding how the marginal effects are depicted.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install <strong>regress3d</strong> from <strong>GitHub</strong>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/" class="external-link">"devtools"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ellaFosterMolina/regress3d"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p><strong>regress3d</strong> allows the user to plot regression surfaces and marginal effects in three dimensions. Linear models, generalized linear models, and either of those model types with interaction terms are currently supported.</p>
<p>A multiple linear regression is shown below using the core two functions in <strong>regress3d</strong>:</p>
<ul>
<li>
<code><a href="reference/add_3d_surface.html">add_3d_surface()</a></code>, and</li>
<li>
<code><a href="reference/add_marginals.html">add_marginals()</a></code>.</li>
</ul>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>Start by calling the two required libraries: <strong>regress3d</strong> and <strong>plotly</strong>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ellaFosterMolina/regress3d" class="external-link">regress3d</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com" class="external-link">plotly</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>The variables in the regression are county level measures from 2016.</p>
<ul>
<li>
<code>r_shift</code>: the shift towards Donald Trump in 2016, as measured as the difference between the county’s vote for Trump in 2016 and the county’s vote for the Republican presidential nominee, Mitt Romney, in 2012,</li>
<li>
<code>median_income16</code>: median income, and</li>
<li>
<code>any_college</code>: the percent of the county that was enrolled in college at some point, regardless of whether they graduated.</li>
</ul>
<p>The regression is weighted by <code>pop_estimate16</code>, the number of people in a county, to capture the influence of large counties.</p>
</div>
<div class="section level3">
<h3 id="model">Model<a class="anchor" aria-label="anchor" href="#model"></a>
</h3>
<p>Specify the model. Here we use a multiple linear regression with two <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> variables.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mymodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">r_shift</span> <span class="op">~</span> <span class="va">median_income16</span> <span class="op">+</span> <span class="va">any_college</span>, </span>
<span>              data <span class="op">=</span> <span class="va">county_data</span>, weight <span class="op">=</span> <span class="va">pop_estimate16</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="regression-surface">Regression surface<a class="anchor" aria-label="anchor" href="#regression-surface"></a>
</h3>
<p>Next, create a <code><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html" class="external-link">plotly::plot_ly()</a></code> object using the same variables and layer on the scattercloud, 3D surface, marginals, and labels. Note that regression notation uses <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>2</mn></msub><annotation encoding="application/x-tex">x_2</annotation></semantics></math> to represent the explanatory variables, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math> for the outcome. The plotly command denotes the explanatory variables as <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>, and the outcome variable is <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html" class="external-link">plot_ly</a></span><span class="op">(</span> data <span class="op">=</span> <span class="va">county_data</span>,</span>
<span>         x <span class="op">=</span> <span class="op">~</span><span class="va">median_income16</span>,</span>
<span>         y <span class="op">=</span> <span class="op">~</span><span class="va">any_college</span>,</span>
<span>         z <span class="op">=</span> <span class="op">~</span><span class="va">r_shift</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/add_trace.html" class="external-link">add_markers</a></span><span class="op">(</span>size <span class="op">=</span> <span class="op">~</span><span class="va">pop_estimate16</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="st">"black"</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/add_3d_surface.html">add_3d_surface</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mymodel</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/add_marginals.html">add_marginals</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mymodel</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">layout</span><span class="op">(</span> </span>
<span>    scene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>xaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'County median income'</span><span class="op">)</span>,</span>
<span>                 yaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'County college experience'</span><span class="op">)</span>,</span>
<span>                 zaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Shift to Trump'</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>The code above renders to an html figure. It displays the outputs of:</p>
<ul>
<li>
<code><a href="reference/add_3d_surface.html">add_3d_surface()</a></code>: a regression surface in translucent blue, and the 95% confidence intervals in translucent grey;</li>
<li>
<code><a href="reference/add_marginals.html">add_marginals()</a></code>: the marginal effects and 95% confidence intervals of each <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> variable with red and orange lines;</li>
<li>
<code><a href="https://rdrr.io/pkg/plotly/man/add_trace.html" class="external-link">plotly::add_markers()</a></code>: a plotly function to create a scattercloud of each county used to generate the regression surface;</li>
<li>
<code>plotly::layout()</code>: a plotly function to adjust the graphic’s labels.</li>
</ul>
<p>The landing page for a package does not support interactive html figures. A gif of the interactive html figure is displayed below to demonstrate some of the functionality of the interactive html image. See <a href="https://ellafostermolina.github.io/regress3d/articles/linear_models_3d.html#improvements-with-plotly" class="uri">https://ellafostermolina.github.io/regress3d/articles/linear_models_3d.html#improvements-with-plotly</a> for an interactive version of this image.</p>
<p><img src="reference/figures/regression-rotating.gif" width="70%"></p>
<p>This graphic corresponds to the following numerical regression results.</p>
<table style="text-align:center" class="table">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
% shift to Trump, 2012-2016
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
County median income ($1,000s)
</td>
<td>
-0.013
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
County college experience
</td>
<td>
-0.344<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.012)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
20.103<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.512)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
3,111
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.371
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
* p&lt;0.05
</td>
</tr>
</table>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ellaFosterMolina/regress3d/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/ellaFosterMolina/regress3d/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing regress3d</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ella Foster-Molina <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-7455-7221" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ellaFosterMolina/regress3d/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/ellaFosterMolina/regress3d/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ella Foster-Molina.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
